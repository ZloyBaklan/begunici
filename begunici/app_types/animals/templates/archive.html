{% extends 'base.html' %}

{% load static %}

{% block content %}
    <h1>
        {% if animal_type == 'Maker' %}
            Архив производителей
        {% elif animal_type == 'Ram' %}
            Архив баранов
        {% elif animal_type == 'Ewe' %}
            Архив ярок
        {% elif animal_type == 'Sheep' %}
            Архив овец
        {% else %}
            Архив животных
        {% endif %}
    </h1>
    
    <!-- Фильтры для архива -->
    <div class="filters">
        <label for="animal-type-filter">Тип животного:</label>
        <select id="animal-type-filter" onchange="filterArchive()">
            <option value="">Все животные</option>
            <option value="Maker">Производители</option>
            <option value="Ram">Бараны</option>
            <option value="Ewe">Ярки</option>
            <option value="Sheep">Овцы</option>
        </select>
        
        <label for="status-filter">Статус:</label>
        <select id="status-filter" onchange="filterArchive()">
            <option value="">Все статусы</option>
            <option value="Убой">Убой</option>
            <option value="Продажа">Продажа</option>
            <option value="Убыл">Убыл</option>
        </select>
        
        <input type="text" id="archive-search" placeholder="Поиск по бирке..." oninput="filterArchive()">
    </div>

    <!-- Таблица архива -->
    <table>
        <thead>
            <tr>
                <th>№</th>
                <th>Тип животного</th>
                <th>Бирка</th>
                <th>Статус</th>
                <th>Дата статуса</th>
                <th>Возраст</th>
                <th>Овчарня</th>
                <th>Действия</th>
            </tr>
        </thead>
        <tbody id="archive-list"></tbody>
    </table>

    <div id="pagination"></div>

    <!-- Подключение скриптов -->
    <script type="module" src="{% static 'js/archive.js' %}"></script>
    <script>
        // Передаем тип животного из контекста Django в JavaScript
        window.initialAnimalType = '{{ animal_type }}';
        
        function filterArchive() {
            const animalType = document.getElementById('animal-type-filter').value;
            const status = document.getElementById('status-filter').value;
            const search = document.getElementById('archive-search').value;
            
            // Вызываем функцию фильтрации из модуля
            if (typeof filterArchiveData === 'function') {
                filterArchiveData(animalType, status, search);
            }
        }
    </script>
{% endblock %}
