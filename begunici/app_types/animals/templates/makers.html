{% extends 'base.html' %}

{% load static %}

{% block content %}
    <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è–º–∏</h1>
    <div class="action-buttons">
        <a href="/animals/main_archive/?type=Maker" class="btn btn-secondary" id="archive-maker-button">–ê—Ä—Ö–∏–≤ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π</a>
        <button class="btn btn-success" onclick="openExportModal('maker')">üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel</button>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ä–∞—Å–∫—Ä—ã—Ç–∏—è —Ñ–æ—Ä–º—ã —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è -->
    <button id="toggle-create-maker-form" onclick="toggleForm()">‚ñº –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è</button>
    <!-- –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è, –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç–∞—è -->
    <input type="text" id="maker-search" placeholder="–ü–æ–∏—Å–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π...">

    <form id="create-maker-form" style="display:none;">
        {% csrf_token %}

        <label for="tag">–ë–∏—Ä–∫–∞:</label>
        <input type="text" id="tag" name="tag" placeholder="–í–≤–µ–¥–∏—Ç–µ –±–∏—Ä–∫—É">

        <label for="animal_status">–°—Ç–∞—Ç—É—Å –∂–∏–≤–æ—Ç–Ω–æ–≥–æ:</label>
        <select id="animal_status" name="animal_status"></select>

        <label for="birth_date">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:</label>
        <input type="date" id="birth_date" name="birth_date">

        <label for="plemstatus">–ü–ª–µ–º–µ–Ω–Ω–æ–π —Å—Ç–∞—Ç—É—Å:</label>
        <input type="text" id="plemstatus" name="plemstatus" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–ª–µ–º–µ–Ω–Ω–æ–π —Å—Ç–∞—Ç—É—Å">
        
        <label for="place">–û–≤—á–∞—Ä–Ω—è:</label>
        <select id="place" name="place"></select>

        <label for="working_condition">–†–∞–±–æ—á–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:</label>
        <input type="text" id="working_condition" name="working_condition" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ä–∞–±–æ—á–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ">

        <label for="note">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</label>
        <input type="text" id="note" name="note" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ">

        <button type="button" id="create-maker-button">–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è</button>

    </form>

    <!-- –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π -->
    <table>
        <thead>
            <tr>
                <th>
                    <label for="select-all">–í—ã–±—Ä–∞—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã</label>
                    <input type="checkbox" id="select-all" onclick="toggleSelectAll(this)">
                </th> <!-- –ß–µ–∫–±–æ–∫—Å –¥–ª—è –≤—ã–±–æ—Ä–∞ –≤—Å–µ—Ö -->
                <th>‚Ññ</th>
                <th>–ë–∏—Ä–∫–∞</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–í–æ–∑—Ä–∞—Å—Ç</th>
                <th>–û–≤—á–∞—Ä–Ω—è</th>
                <th>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –í–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ</th>
                <th>–ü–æ—Å–ª–µ–¥–Ω—è—è –í–µ—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞</th>
                <th>–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã</th>
                <th>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</th>
            </tr>
        </thead>
        <tbody id="maker-list"></tbody>
    </table>
    
    <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö -->
    <button id="delete-selected-button" style="display:none;" onclick="deleteSelectedMakers()">–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ</button>
    <button id="archive-selected-button" style="display:none;" onclick="openArchiveModal()">–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ –∞—Ä—Ö–∏–≤</button>

    
    <div id="pagination"></div> <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ -->

    <div id="delete-modal" style="display:none;">
        <h2>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è</h2>
        <p id="delete-modal-message"></p>
        <button id="delete-confirm-button">–î–∞</button>
        <button onclick="closeDeleteModal()">–ù–µ—Ç</button>
    </div>
    

    <div id="archive-modal" style="display:none;">
        <h2>–ü–µ—Ä–µ–Ω–æ—Å –≤ –∞—Ä—Ö–∏–≤</h2>
        <p>–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–∞—Ç—É—Å, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö:</p>
        <select id="archive-status-select"></select>
        <button onclick="applyArchiveStatus()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
        <button onclick="closeArchiveModal()">–û—Ç–º–µ–Ω–∞</button>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel -->
    <div id="export-modal" class="modal" style="display:none;">
        <div class="modal-content export-modal-content">
            <h2>–≠–∫—Å–ø–æ—Ä—Ç –≤ Excel</h2>
            
            <div class="export-filters">
                <!-- –§–∏–ª—å—Ç—Ä –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É -->
                <div class="filter-group">
                    <label>
                        <input type="checkbox" id="filter-limit-enabled"> 
                        –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–≤—ã–µ N –∂–∏–≤–æ—Ç–Ω—ã—Ö
                    </label>
                    <input type="number" id="filter-limit" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ" min="1" disabled>
                </div>
                
                <!-- –§–∏–ª—å—Ç—Ä –ø–æ –≤–µ—Å—É -->
                <div class="filter-group">
                    <label>
                        <input type="checkbox" id="filter-weight-enabled"> 
                        –§–∏–ª—å—Ç—Ä –ø–æ –≤–µ—Å—É (–∫–≥)
                    </label>
                    <div class="range-inputs">
                        <input type="number" id="filter-weight-min" placeholder="–û—Ç" step="0.1" disabled>
                        <input type="number" id="filter-weight-max" placeholder="–î–æ" step="0.1" disabled>
                    </div>
                </div>
                
                <!-- –§–∏–ª—å—Ç—Ä –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É -->
                <div class="filter-group">
                    <label>
                        <input type="checkbox" id="filter-age-enabled"> 
                        –§–∏–ª—å—Ç—Ä –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É (–º–µ—Å—è—Ü—ã)
                    </label>
                    <div class="range-inputs">
                        <input type="number" id="filter-age-min" placeholder="–û—Ç" step="0.1" disabled>
                        <input type="number" id="filter-age-max" placeholder="–î–æ" step="0.1" disabled>
                    </div>
                </div>
                
                <!-- –í–∫–ª—é—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ -->
                <div class="filter-group">
                    <label>
                        <input type="checkbox" id="include-details"> 
                        –í–∫–ª—é—á–∏—Ç—å —Ä–æ–¥–∏—Ç–µ–ª–µ–π, –¥–µ—Ç–µ–π –∏ –∏—Å—Ç–æ—Ä–∏—é (–≤–µ—Å, –≤–µ—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∏)
                    </label>
                </div>
            </div>
            
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="performExport('maker')">–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                <button class="btn btn-secondary" onclick="closeExportModal()">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>
    

    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ -->
    <script type="module" src="{% static 'js/makers.js' %}"></script>
    <script src="{% static 'js/export-common.js' %}"></script>
    <script>
    

        function toggleForm() {
            const form = document.getElementById('create-maker-form');
            form.style.display = form.style.display === 'none' ? 'block' : 'none';
        }

        function searchMakers() {
            const query = document.getElementById('maker-search').value;
            fetchMakers(query); // –ü–æ–∏—Å–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π
        }

        function toggleSelectAll(checkbox) {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∏–∑ makers.js
            window.toggleSelectAll(checkbox);
        }
    </script>


{% endblock %}