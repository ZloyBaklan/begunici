{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container-fluid">
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="mb-3">Управление ветобработками</h1>
        </div>
    </div>

    <div class="row">
        <!-- Форма создания/редактирования -->
        <div class="col-lg-4 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0" id="form-title">Создать обработку</h5>
                </div>
                <div class="card-body">
                    {% csrf_token %}
                    <form id="create-care-form">
                        <div class="mb-3">
                            <label for="care-type" class="form-label">Тип обработки:</label>
                            <input type="text" id="care-type" name="care-type" class="form-control" placeholder="Введите тип обработки">
                        </div>

                        <div class="mb-3">
                            <label for="care-name" class="form-label">Название обработки:</label>
                            <input type="text" id="care-name" name="care-name" class="form-control" placeholder="Введите название">
                        </div>

                        <div class="mb-3">
                            <label for="medication" class="form-label">Препарат/материал:</label>
                            <input type="text" id="medication" name="medication" class="form-control" placeholder="Введите название препарата">
                        </div>

                        <div class="mb-3">
                            <label for="purpose" class="form-label">Цель обработки:</label>
                            <input type="text" id="purpose" name="purpose" class="form-control" placeholder="Введите цель обработки">
                        </div>

                        <div class="mb-3">
                            <label for="default-duration-days" class="form-label">Срок действия (дней):</label>
                            <input type="number" id="default-duration-days" name="default-duration-days" value="0" min="0" class="form-control" placeholder="0 = бессрочно">
                            <div class="form-text">0 дней = бессрочное действие</div>
                        </div>

                        <div class="d-grid gap-2">
                            <button type="button" id="create-care-button" class="btn btn-primary" onclick="handleCreateOrUpdateCare()">
                                Создать обработку
                            </button>
                            <button type="button" id="cancel-edit-button" class="btn btn-secondary" onclick="cancelEdit()" style="display: none;">
                                Отменить редактирование
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Список обработок -->
        <div class="col-lg-8 mb-4">
            <div class="card">
                <div class="card-header">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <h5 class="card-title mb-0">Список обработок</h5>
                        </div>
                        <div class="col-md-6">
                            <input type="text" id="care-search" class="form-control" placeholder="Поиск по обработкам...">
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-light">
                                <tr>
                                    <th width="5%">№</th>
                                    <th width="15%">Тип обработки</th>
                                    <th width="20%">Название</th>
                                    <th width="15%">Препарат</th>
                                    <th width="15%">Цель</th>
                                    <th width="10%">Срок действия</th>
                                    <th width="20%">Действия</th>
                                </tr>
                            </thead>
                            <tbody id="care-list">
                                <!-- Данные будут загружены через JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Пагинация -->
                    <div id="pagination" class="mt-3"></div>
                    
                    <!-- Сообщения -->
                    <div id="care-message" class="alert" style="display: none;" role="alert"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="module" src="{% static 'js/vet_cares.js' %}"></script>

<style>
/* Дополнительные стили для страницы */
.table th {
    border-top: none;
    font-weight: 600;
}

.table td {
    vertical-align: middle;
}

.btn-group-sm .btn {
    padding: 0.25rem 0.5rem;
    font-size: 0.875rem;
}

.form-text {
    font-size: 0.875em;
    color: #6c757d;
}

/* Стили для сообщений */
.alert {
    margin-top: 1rem;
}

/* Адаптивность для мобильных */
@media (max-width: 768px) {
    .col-lg-4, .col-lg-8 {
        margin-bottom: 1rem;
    }
    
    .table-responsive {
        font-size: 0.875rem;
    }
    
    .btn-group-sm .btn {
        padding: 0.2rem 0.4rem;
        font-size: 0.75rem;
    }
}
</style>

{% endblock %}
